package  {	import flash.display.MovieClip;	import flash.events.*	import flash.text.TextField;	import flash.display.Sprite;	import flash.utils.Dictionary;	import flash.geom.Point;	import org.casalib.*;		import com.greensock.*;	import com.greensock.easing.*;	import com.greensock.events.LoaderEvent;	import com.greensock.loading.*;		import com.greensock.plugins.*;	import org.casalib.layout.Distribution;	import fl.containers.ScrollPane;		public class Selector extends MovieClip	{				private var _loaderMax:LoaderMax;		private var _myCategoryPageArray:Array;		private var _myTabsArray:Array;		private var _xmlTab1:XML;		private var _xmlTab2:XML;		private var _xmlTab3:XML;		private var myCategoryPage1:CategoryPage;		private var myCategoryPage2:CategoryPage;		private var myCategoryPage3:CategoryPage;		private var myPopup:PopUp;				private var _dictTabs:Dictionary = new Dictionary();		private var _dict:Dictionary = new Dictionary();				public function Selector() {			TweenPlugin.activate([TintPlugin,AutoAlphaPlugin]);			loadXML();		}		private function loadXML():void {			_loaderMax = new LoaderMax({name:"mainQueue", onComplete:completeHandler});			_loaderMax.append( new XMLLoader("xml/tab1.xml", {name:"xmlTab1"}) );			_loaderMax.append( new XMLLoader("xml/tab2.xml", {name:"xmlTab2"}) );			_loaderMax.append( new XMLLoader("xml/tab3.xml", {name:"xmlTab3"}) );						_loaderMax.load();		}				private function completeHandler(event:LoaderEvent):void {			_xmlTab1 = LoaderMax.getContent("xmlTab1");			_xmlTab2 = LoaderMax.getContent("xmlTab2");			_xmlTab3 = LoaderMax.getContent("xmlTab3");						// create the category pages:			myCategoryPage3 = new CategoryPage(_xmlTab3);			addChild(myCategoryPage3);			myCategoryPage3.visible = false;			myCategoryPage2 = new CategoryPage(_xmlTab2);			addChild(myCategoryPage2);			myCategoryPage2.visible = false;			myCategoryPage1 = new CategoryPage(_xmlTab1);			addChild(myCategoryPage1);									// create the tabs dictionnary:			_dictTabs[topTabs.tabTop1] = myCategoryPage1;			_dictTabs[topTabs.tabTop2] = myCategoryPage2;			_dictTabs[topTabs.tabTop3] = myCategoryPage3;			// Init tabs:			initTabs();						// create a popup:			createPopup();		}		private function createPopup():void 		{			// create a popup			myPopup = new PopUp();			myPopup.x = -500; // move popup out of stage			myPopup.alpha = 0;			addChild(myPopup);			this.addEventListener("productButtonOver", productButtonOver);			this.addEventListener("productButtonOut", productButtonOut);					}				private function productButtonOver(e:Event):void 		{			var pt:Point = new Point(e.target.x, e.target.y);			pt = e.target.parent.localToGlobal(pt);			// move the popup next to the product button			myPopup.x = pt.x;			myPopup.y = pt.y;			myPopup.updateContent(e.target.category, e.target.myProductXML) 			TweenLite.to(myPopup, .3, {autoAlpha:1}); 		}		private function productButtonOut(e:Event):void 		{			TweenLite.to(myPopup, .3, {autoAlpha:0}); 		}				private function initTabs():void 		{			topTabs.tabTop1.addEventListener(MouseEvent.CLICK, switchTab);			topTabs.tabTop2.addEventListener(MouseEvent.CLICK, switchTab);			topTabs.tabTop3.addEventListener(MouseEvent.CLICK, switchTab);			topTabs.tabTop1.useHandCursor = topTabs.tabTop2.useHandCursor = topTabs.tabTop3.useHandCursor = true;			topTabs.tabTop1.buttonMode = topTabs.tabTop2.buttonMode = topTabs.tabTop3.buttonMode = true;			// change first tab color to white			TweenLite.to(topTabs.tabTop1.tabTopBgd, 0, {tint:0xffffff});					}				private function switchTab(e:MouseEvent):void 		{ 			var maxIndex:Number = topTabs.numChildren-1;						// move the selected tab to the top			this.setChildIndex(_dictTabs[e.currentTarget],maxIndex);						TweenLite.to(topTabs.tabTop1.tabTopBgd, .5, {tint:0xf5f5f5}); 			TweenLite.to(topTabs.tabTop2.tabTopBgd, .5, {tint:0xf5f5f5}); 			TweenLite.to(topTabs.tabTop3.tabTopBgd, .5, {tint:0xf5f5f5}); 			// change the selected tab to white:			TweenLite.to(e.currentTarget.tabTopBgd, .5, {tint:0xffffff}); 						// hide every category page:			for (var k in _dictTabs) 			{				_dictTabs[k].visible = false;							}			// show the current category page:			_dictTabs[e.currentTarget].visible = true;			// show the first category page:			myCategoryPage1.showFirstCategoryPage("Incandescent600W")			myCategoryPage2.showFirstCategoryPage("FluorescentElectronicMark10Powerline120V500W")			myCategoryPage3.showFirstCategoryPage("Switch5AIncandescentOnly")					}			}}